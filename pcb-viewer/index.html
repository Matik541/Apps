<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PCB Viewer</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        .sortable {
            user-select: none;
        }

        .sortable::after {
            content: "▼";
            opacity: 0;
        }

        .sort-asc::after {
            content: "▼";
            opacity: 1;
        }

        .sort-desc::after {
            content: "▲";
            opacity: 1;
        }

        .image-container {
            position: relative;
            cursor: grab;
            overflow: hidden;
            width: 100%;
            height: auto;
        }

        .image-container:active {
            cursor: grabbing;
        }

        #image,
        #overlay {
            position: absolute;
            top: 0;
            left: 0;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
    </style>
</head>

<body class="bg-gray-100 p-4 font-sans">

    <h3 class="flex items-center space-x-4 mb-4">
        <label class="block">
            <span class="text-gray-700">Wybierz plik Pick&Place:</span>
            <input type="file" id="pickPlaceInput" class="block w-full text-sm text-gray-500
                file:mr-4 file:py-2 file:px-4
                file:rounded-full file:border-0
                file:text-sm file:font-semibold
                file:bg-blue-50 file:text-blue-700
                hover:file:bg-blue-100 cursor-pointer" />
        </label>
        <label class="block">
            <span class="text-gray-700">Wybierz plik PCB:</span>
            <input type="file" id="PCBInput" class="block w-full text-sm text-gray-500
                file:mr-4 file:py-2 file:px-4
                file:rounded-full file:border-0
                file:text-sm file:font-semibold
                file:bg-blue-50 file:text-blue-700
                hover:file:bg-blue-100 cursor-pointer" />
        </label>
    </h3>

    <div id="app" class="flex flex-col lg:flex-row gap-4">
        <div id="tableContainer" class="flex flex-col gap-4 ">
            <div class="bg-white p-4 shadow-md">
                <h4 class="text-lg font-semibold mb-2">Zaznacz desygnatory</h4>
                <textarea id="designatorsInput"
                    class="w-full h-32 p-2 mb-2 border rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Wklej listę desygnatorów (np. R1, C12, U5)..."></textarea>
                <button id="markButton"
                    class="w-full px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 transition">Zaznacz
                    na liście</button>
            </div>

            <div class="bg-white shadow-md">
                <table id="components" class="divide-y divide-gray-200">
                    <thead class="bg-gray-50 sticky top-0">
                        <tr>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer sortable"
                                data-column="id">#</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer sortable"
                                data-column="designator">Designator</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer sortable"
                                data-column="layer">Layer</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer sortable"
                                data-column="centerX">Center−X</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer sortable"
                                data-column="centerY">Center−Y</th>
                            <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer sortable"
                                data-column="rotation">Rotation</th>
                            <th
                                class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sortable">
                                Pokaż</th>
                        </tr>
                        <tr>
                            <th colspan="6" class="px-3 py-2 bg-gray-100">
                                <div id="layers" class="flex flex-wrap gap-2"></div>
                            </th>
                            <th class="px-3 py-2 bg-gray-100 text-right">
                                <div id="selectedCounter" class="text-sm text-gray-600">0</div>
                            </th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="componentsBody"></tbody>
                </table>
            </div>
        </div>

        <div id="preview" class="w-full bg-white shadow-md">
            <div id="controls"
                class="flex flex-wrap items-center justify-between p-2 bg-gray-50 border-b border-gray-200">
                <div id="transformControls" class="flex items-center space-x-2 text-sm">
                    <label>X: <input type="number" id="offsetX" value="0" step="0.1"
                            class="w-16 p-1 border rounded-md"></label>
                    <label>Y: <input type="number" id="offsetY" value="0" step="0.1"
                            class="w-16 p-1 border rounded-md"></label>
                    <label>Skala: <input type="number" id="scale" value="1" step="0.1"
                            class="w-16 p-1 border rounded-md"></label>
                    <label title="Nie taki sam jak z myszy!">Zoom: <input type="number" id="resolution" value="10" step="0.05"
                            class="w-20 p-1 border rounded-md"></label>
                    <label>Obrót (&deg;): <input type="number" id="rotationInput" value="0" step="0.1"
                        class="w-16 p-1 border rounded-md"></label>
                    <button id="rotateBtn" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition">Obróć</button>
                </div>
                <div id="toggleControls" class="flex items-center space-x-4 text-sm mt-2 lg:mt-0">
                    <span>Kropki</span>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="toggleNames" class="sr-only peer" checked>
                        <div
                            class="w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-2 peer-focus:ring-blue-500 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
                        </div>
                    </label>
                    <span>Designatory</span>
                </div>
                <div class="flex space-x-2 mt-2 lg:mt-0">
                    <button id="mirrorXBtn" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition">Odbij V</button>
                    <button id="mirrorYBtn" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition">Odbij H</button>
                    <button id="saveCanvasBtn"
                        class="px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 transition">Zapisz</button>
                    <button id="copyCanvasBtn"
                        class="px-4 py-2 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 transition">Kopiuj</button>
                </div>
            </div>
            <div class="image-container">
                <img id="image" />
                <canvas id="overlay"></canvas>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>